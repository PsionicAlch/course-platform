{{ template "admin" .}}

{{ define "meta-tags" }}
  {{/* TODO: Generate SEO Tags with ChatGPT. */}}
{{ end }}

{{ define "title" }}
  <title>Users - PsionicAlch</title>
{{ end }}

{{ define "body" }}
<section class="admin-container">
  <div class="admin-header" x-data="{ modalOpen: false }">
    <h2>Users Administration</h2>

    <div class="admin-header-actions">
      <form method="/">
        <input type="text" name="search-term" id="search-term" class="shadow-sm" placeholder="Search terms...">
      </form>

      <button class="btn btn-blue shadow-sm" x-on:click="modalOpen = true">Add New User</button>
    </div>

    <template x-teleport="body">
      <section class="admin-modal" x-show="modalOpen">
        <div class="admin-modal-container shadow-sm">
          <div class="admin-modal-header">
            <h2>Add New Admin</h2>
          </div>

          <div class="admin-modal-body">
            <form action="/">
              <div class="form-control">
                <label for="first-name">First Name:</label>
                <input type="text" name="first-name" id="first-name" class="shadow-sm">
              </div>

              <div class="form-control">
                <label for="last-name">Last Name:</label>
                <input type="text" name="last-name" id="last-name" class="shadow-sm">
              </div>

              <div class="form-control">
                <label for="email">Email:</label>
                <input type="email" name="email" id="email" class="shadow-sm">
              </div>

              <div class="form-control" x-data="auth">
                <label for="password">Password:</label>

                <div class="password-control">
                  <input x-bind:type="inputType" name="password" id="password">

                  <div class="visibility-control" x-on:click="toggle">
                    <template x-if="passwordVisible">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                        <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                        <path fill-rule="evenodd" d="M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 0 1 0-1.113ZM17.25 12a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Z" clip-rule="evenodd" />
                      </svg>
                    </template>

                    <template x-if="!passwordVisible">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                        <path d="M3.53 2.47a.75.75 0 0 0-1.06 1.06l18 18a.75.75 0 1 0 1.06-1.06l-18-18ZM22.676 12.553a11.249 11.249 0 0 1-2.631 4.31l-3.099-3.099a5.25 5.25 0 0 0-6.71-6.71L7.759 4.577a11.217 11.217 0 0 1 4.242-.827c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113Z" />
                        <path d="M15.75 12c0 .18-.013.357-.037.53l-4.244-4.243A3.75 3.75 0 0 1 15.75 12ZM12.53 15.713l-4.243-4.244a3.75 3.75 0 0 0 4.244 4.243Z" />
                        <path d="M6.75 12c0-.619.107-1.213.304-1.764l-3.1-3.1a11.25 11.25 0 0 0-2.63 4.31c-.12.362-.12.752 0 1.114 1.489 4.467 5.704 7.69 10.675 7.69 1.5 0 2.933-.294 4.242-.827l-2.477-2.477A5.25 5.25 0 0 1 6.75 12Z" />
                      </svg>
                    </template>
                  </div>
                </div>
              </div>

              <div class="admin-modal-actions">
                <button
                  x-on:click.prevent="modalOpen = false"
                  class="btn btn-gray shadow-sm"
                >
                  Cancel
                </button>

                <button type="submit" class="btn btn-blue shadow-sm">Add User</button>
              </div>
            </form>
          </div>
        </div>
      </section>
    </template>
  </div>

  <hr>

  <div class="admin-body shadow-sm" x-data="users_data">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Created At</th>
          <th>Updated At</th>
          <th>First Name</th>
          <th>Last Name</th>
          <th>Affiliate Code</th>
          <th>Affiliate Points</th>
          <th>Tutorials Liked</th>
          <th>Tutorials Bookmarked</th>
          <th>Courses Bought</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <template x-for="user in users">
          <tr>
            <td x-text="user.id"></td>
            <td x-text="user.createdAt"></td>
            <td x-text="user.updatedAt"></td>
            <td x-text="user.firstName"></td>
            <td x-text="user.lastName"></td>
            <td><a href="/admin/purchases?affiliate_code=INSERT_AFFILIATE_CODE_ID" x-text="user.affiliateCode"></a></td>
            <td x-text="user.affiliatePoints"></td>
            <td><a href="/admin/tutorials?liked_by=INSERT_USER_ID" x-text="user.tutorialsLiked"></a></td>
            <td><a href="/admin/tutorials?bookmarked_by=INSERT_USER_ID" x-text="user.tutorialsBookmarked">24</a></td>
            <td><a href="/admin/purchases?user_id=INSERT_USER_ID" x-text="user.coursesBought">5</a></td>
            <td><button class="btn btn-red shadow-sm" x-on:click="openModal(user.firstName, user.lastName, user.id)">Delete User</button></td>
          </tr>
        </template>
      </tbody>
    </table>

    <template x-teleport="body">
      <section class="admin-modal" x-show="modalOpen">
        <div class="admin-modal-container shadow-sm">
          <div class="admin-modal-header">
            <h2>Delete <span x-text="selectedFirstName"></span> <span x-text="selectedLastName"></span>'s Account</h2>

            <p>You are about to permanently delete this user's account. There is no going back once this has been done, the user will lose all of their account data along with all the courses they bought. This could lead to some serious repercussions. Are you 100% sure that this is something you want to do?</p>
          </div>

          <div class="admin-modal-body">
            <form>
              <div class="admin-modal-actions">
                <button
                  x-on:click.prevent="modalOpen = false"
                  class="btn btn-gray shadow-sm"
                >
                  Cancel
                </button>

                <button type="submit" class="btn btn-red shadow-sm">Delete User's Account</button>
              </div>
            </form>
          </div>
        </div>
      </section>
    </template>
  </div>


</section>
{{ end }}

{{ define "javascript" }}
<script>
  document.addEventListener("alpine:init", () => {
    Alpine.data('auth', () => ({
      passwordVisible: false,
      inputType: 'password',
      toggle() {
        this.passwordVisible = !this.passwordVisible;

        this.inputType = this.passwordVisible ? 'text' : 'password';
      }
    }));

    Alpine.data('users_data', () => ({
      modalOpen: false,
      users: [
        {
          id: "01A8E54F1RYQJYQGF4ZTWM16V8",
          createdAt: "2023-01-15",
          updatedAt: "2023-02-01",
          firstName:  "John",
          lastName:  "Doe",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked:  10,
          tutorialsBookmarked:  24,
          coursesBought: 5,
        },
        {
          id: "01A8E8J7E2YMG98NKF3TQ84G1H",
          createdAt: "2023-03-12",
          updatedAt: "2023-03-27",
          firstName:  "Jane",
          lastName:  "Smith",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked: 32,
          tutorialsBookmarked: 31,
          coursesBought: 25,
        },
        {
          id: "01A8EC3WZ4FJYP62PG6T0M5CBX",
          createdAt: "2023-04-03",
          updatedAt: "2023-04-22",
          firstName: "Michael",
          lastName: "Johnson",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked: 46,
          tutorialsBookmarked: 16,
          coursesBought: 45,
        },
        {
          id: "01A8F2QW0ZGM3WXNQHC9R1SVDN",
          createdAt: "2023-05-10",
          updatedAt: "2023-06-01",
          firstName: "Emily",
          lastName: "Brown",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked: 53,
          tutorialsBookmarked: 84,
          coursesBought: 74,
        },
        {
          id: "01A8F8YRQ7JQF8X0XCHN5WT4F9",
          createdAt: "2023-06-15",
          updatedAt: "2023-07-05",
          firstName: "Chris",
          lastName: "Davis",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked: 78,
          tutorialsBookmarked: 91,
          coursesBought: 920,
        },
        {
          id: "01A8FESM8ZGFKP0YQDJ2XN9HJB",
          createdAt: "2023-07-18",
          updatedAt: "2023-08-08",
          firstName: "Sarah",
          lastName: "Miller",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked: 5,
          tutorialsBookmarked: 11,
          coursesBought: 64,
        },
        {
          id: "01A8FTM3XMKZ6C8N0V6SD3ZYND",
          createdAt: "2023-08-10",
          updatedAt: "2023-08-25",
          firstName: "James",
          lastName: "Wilson",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked: 0,
          tutorialsBookmarked: 324,
          coursesBought: 637,
        },
        {
          id: "01A8FXV0Q6P9Z9FJKM2TB8WQH4",
          createdAt: "2023-09-12",
          updatedAt: "2023-10-01",
          firstName: "Amanda",
          lastName: "Taylor",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked: 320,
          tutorialsBookmarked: 63,
          coursesBought: 758,
        },
        {
          id: "01A8G2ZV7FGRX8ZQCBYKW5TY2L",
          createdAt: "2023-10-07",
          updatedAt: "2023-10-22",
          firstName: "David",
          lastName: "Anderson",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked: 56,
          tutorialsBookmarked: 14,
          coursesBought: 89,
        },
        {
          id: "01A8G6XDRKJ8C3R1ZJN4Y2Q6P5",
          createdAt: "2023-10-20",
          updatedAt: "2023-11-05",
          firstName: "Laura",
          lastName: "Thomas",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked: 760,
          tutorialsBookmarked:  75,
          coursesBought: 62,
        },
        {
          id: "01A8G9WEFK9ZMQ6JV8L9Z6C7QD",
          createdAt: "2023-11-10",
          updatedAt: "2023-11-30",
          firstName: "Brian",
          lastName: "Jackson",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked: 79,
          tutorialsBookmarked: 84,
          coursesBought: 16,
        },
        {
          id: "01A8GJMW6P4H9F8WZJ6H5TL0YV",
          createdAt: "2023-11-20",
          updatedAt: "2023-12-01",
          firstName: "Jessica",
          lastName: "White",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked: 89,
          tutorialsBookmarked: 654,
          coursesBought: 15,
        },
        {
          id: "01A8GLY9FT8MW8ZJ3NQ6ZYJVDX",
          createdAt: "2023-12-03",
          updatedAt: "2023-12-12",
          firstName: "Oliver",
          lastName: "Lee",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked: 32,
          tutorialsBookmarked: 90,
          coursesBought: 1,
        },
        {
          id: "01A8GP3V9DJQY6MW6F4H8R5DZT",
          createdAt: "2023-12-10",
          updatedAt: "2023-12-15",
          firstName: "Sophia",
          lastName: "Martinez",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked: 65,
          tutorialsBookmarked: 814,
          coursesBought: 5,
        },
        {
          id: "01A8GR5S1NZKW7TCQKH4G8V9PL",
          createdAt: "2023-12-15",
          updatedAt: "2023-12-20",
          firstName: "Daniel",
          lastName: "Lopez",
          affiliateCode: "01A8E54F1RYQJYQGF4ZTWM16V8",
          affiliatePoints: 24,
          tutorialsLiked: 21,
          tutorialsBookmarked: 24,
          coursesBought: 85
        }
      ],
      selectedFirstName: "",
      selectedLastName: "",
      selectedID: "",

      openModal(firstName, lastName, id) {
        this.selectedFirstName = firstName;
        this.selectedLastName = lastName;
        this.selectedID = id;

        this.modalOpen = true;
      },

      closeModal() {
        this.selectedFirstName = "";
        this.selectedLastName = "";
        this.selectedID = "";

        this.modalOpen = false;
      }
    }));
  });
</script>
{{ end }}
